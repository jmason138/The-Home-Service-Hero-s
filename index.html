<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HOME SERVICE HERO: TRADES AT WAR</title>
    <style>
        /* --- HIGH-END ARCADE STYLING --- */
        :root {
            --hero-gold: #ffcc00;
            --neon-blue: #00f2ff;
            --dark-bg: #0a0a0a;
            --danger-red: #ff3e3e;
        }

        body {
            margin: 0;
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            color: white;
            font-family: 'Arial Black', sans-serif;
            overflow: hidden;
        }

        #game-viewport {
            position: relative;
            width: 800px;
            height: 600px;
            border: 4px solid #333;
            background: #111;
            box-shadow: 0 0 50px rgba(0,0,0,1), 0 0 30px rgba(255, 204, 0, 0.15);
        }

        /* --- THE PRO MENU --- */
        #menu {
            position: absolute;
            inset: 0;
            background: linear-gradient(rgba(0,0,0,0.9), rgba(15,15,15,0.85));
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            text-align: center;
        }

        h1 {
            font-size: 4.5rem;
            margin: 0;
            color: var(--hero-gold);
            text-transform: uppercase;
            letter-spacing: -2px;
            text-shadow: 4px 4px 0px #000, 0 0 20px rgba(255, 204, 0, 0.4);
            line-height: 0.85;
        }

        .subtitle {
            font-size: 1.1rem;
            color: var(--neon-blue);
            margin-bottom: 30px;
            letter-spacing: 5px;
            font-weight: bold;
        }

        #best-score {
            font-size: 1.4rem;
            margin-bottom: 25px;
            color: #fff;
            background: rgba(255,255,255,0.1);
            padding: 5px 20px;
            border-radius: 50px;
        }

        .btn-container { display: flex; gap: 25px; }

        button {
            padding: 20px 45px;
            font-size: 1.1rem;
            font-weight: 900;
            cursor: pointer;
            border: 3px solid var(--hero-gold);
            background: transparent;
            color: var(--hero-gold);
            text-transform: uppercase;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        button:hover {
            background: var(--hero-gold);
            color: #000;
            transform: scale(1.1) rotate(-2deg);
            box-shadow: 0 0 25px var(--hero-gold);
        }

        .controls-hint {
            margin-top: 40px;
            font-size: 0.75rem;
            color: #555;
            letter-spacing: 2px;
        }

        canvas { display: block; }
    </style>
</head>
<body>

<div id="game-viewport">
    <div id="menu">
        <h1>HOME SERVICE<br>HERO</h1>
        <div class="subtitle">TRADES AT WAR</div>
        <div id="best-score">RECORD: 0</div>
        
        <div class="btn-container">
            <button onclick="initGame('hvac')">HVAC TECH</button>
            <button onclick="initGame('roofer')">ROOFER</button>
        </div>
        
        <div class="controls-hint">[SPACE] TO JUMP | [GOLD MODE] SMASHES OBSTACLES</div>
    </div>

    <canvas id="gameCanvas" width="800" height="600"></canvas>
</div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const menu = document.getElementById('menu');

    // --- LOGIC STATE ---
    let state = {
        active: false,
        score: 0,
        highScore: localStorage.getItem('heroHS') || 0,
        speed: 8,
        isGold: false,
        goldTimer: 0,
        job: 'hvac'
    };

    document.getElementById('best-score').innerText = `RECORD: ${Math.floor(state.highScore)}`;

    // --- ASSET MANAGEMENT ---
    const assets = {};
    const sources = {
        bg: 'game_bg.jpg',
        hvac_normal: 'hvac_normal.png',
        hvac_gold: 'hvac_gold.png',
        roofer_normal: 'roofer_normal.png',
        roofer_gold: 'roofer_gold.png',
        van: 'van.png',
        cone: 'obstacle_cone.png',
        crack: 'obstacle_crack.png',
        barricade: 'obstacle_barricade.png',
        lowbid: 'obstacle_lowbid.png',
        energy: 'energy_drink.png'
    };

    // Load assets with error handling to prevent "white screen"
    Object.keys(sources).forEach(key => {
        assets[key] = new Image();
        assets[key].src = sources[key];
        assets[key].onerror = () => console.warn(`Missing: ${key}`);
    });

    const player = { x: 620, y: 435, w: 100, h: 100, dy: 0, jump: 18, grav: 0.85, grounded: false };
    let obstacles = [];
    let items = [];

    function initGame(selectedJob) {
        state.job = selectedJob;
        state.active = true;
        state.score = 0;
        state.speed = 8.5
